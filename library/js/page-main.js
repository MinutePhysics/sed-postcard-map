/** @license
 * RequireJS plugin for async dependency load like JSONP and Google Maps
 * Author: Miller Medeiros
 * Version: 0.1.1 (2011/11/17)
 * Released under the MIT license
 */

/**
 * @license RequireJS text 2.0.10 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

// doT.js
// 2011, Laura Doktorova, https://github.com/olado/doT
// Licensed under the MIT license.

/** @license
 * RequireJS plugin for loading JSON files
 * - depends on Text plugin and it was HEAVILY "inspired" by it as well.
 * Author: Miller Medeiros
 * Version: 0.3.2 (2013/08/17)
 * Released under the MIT license
 */

function d(e){return function(t){this[e]=t}}function f(e){return function(){return this[e]}}function l(e,t,n){this.extend(l,google.maps.OverlayView),this.b=e,this.a=[],this.f=[],this.da=[53,56,66,78,90],this.j=[],this.A=!1,n=n||{},this.g=n.gridSize||60,this.l=n.minimumClusterSize||2,this.K=n.maxZoom||null,this.j=n.styles||[],this.Y=n.imagePath||this.R,this.X=n.imageExtension||this.Q,this.P=!0,void 0!=n.zoomOnClick&&(this.P=n.zoomOnClick),this.r=!1,void 0!=n.averageCenter&&(this.r=n.averageCenter),m(this),this.setMap(e),this.L=this.b.getZoom();var r=this;google.maps.event.addListener(this.b,"zoom_changed",function(){var e=r.b.getZoom(),t=r.b.minZoom||0,n=Math.min(r.b.maxZoom||100,r.b.mapTypes[r.b.getMapTypeId()].maxZoom),e=Math.min(Math.max(e,t),n);r.L!=e&&(r.L=e,r.m())}),google.maps.event.addListener(this.b,"idle",function(){r.i()}),t&&(t.length||Object.keys(t).length)&&this.C(t,!1)}function m(e){if(!e.j.length)for(var t=0,n;n=e.da[t];t++)e.j.push({url:e.Y+(t+1)+"."+e.X,height:n,width:n})}function s(e,t){t.s=!1,t.draggable&&google.maps.event.addListener(t,"dragend",function(){t.s=!1,e.M()}),e.a.push(t)}function t(e,t){var n=-1;if(e.a.indexOf)n=e.a.indexOf(t);else for(var r=0,i;i=e.a[r];r++)if(i==t){n=r;break}return-1==n?!1:(t.setMap(null),e.a.splice(n,1),!0)}function p(e){if(e.A)for(var t=new google.maps.LatLngBounds(e.b.getBounds().getSouthWest(),e.b.getBounds().getNorthEast()),t=e.v(t),n=0,r;r=e.a[n];n++)if(!r.s&&t.contains(r.getPosition())){for(var i=e,s=4e4,o=null,u=0,a=void 0;a=i.f[u];u++){var f=a.getCenter();if(f){var l=r.getPosition();if(f&&l)var c=(l.lat()-f.lat())*Math.PI/180,h=(l.lng()-f.lng())*Math.PI/180,f=Math.sin(c/2)*Math.sin(c/2)+Math.cos(f.lat()*Math.PI/180)*Math.cos(l.lat()*Math.PI/180)*Math.sin(h/2)*Math.sin(h/2),f=12742*Math.atan2(Math.sqrt(f),Math.sqrt(1-f));else f=0;f<s&&(s=f,o=a)}}o&&o.F.contains(r.getPosition())?o.q(r):(a=new v(i),a.q(r),i.f.push(a))}}function v(e){this.k=e,this.b=e.getMap(),this.g=e.I(),this.l=e.l,this.r=e.r,this.d=null,this.a=[],this.F=null,this.n=new w(this,e.w())}function A(e){var t=new google.maps.LatLngBounds(e.d,e.d);e.F=e.k.v(t)}function w(e,t){e.k.extend(w,google.maps.OverlayView),this.j=t,this.u=e,this.d=null,this.b=e.getMap(),this.B=this.c=null,this.t=!1,this.setMap(this.b)}function C(e,t){var n=e.getProjection().fromLatLngToDivPixel(t);return n.x-=parseInt(e.p/2,10),n.y-=parseInt(e.h/2,10),n}function B(e){e.c&&(e.c.style.display="none"),e.t=!1}function D(e,t){var n=[];return n.push("background-image:url("+e.ea+");"),n.push("background-position:"+(e.D?e.D:"0 0")+";"),"object"==typeof e.e?("number"==typeof e.e[0]&&0<e.e[0]&&e.e[0]<e.h?n.push("height:"+(e.h-e.e[0])+"px; padding-top:"+e.e[0]+"px;"):n.push("height:"+e.h+"px; line-height:"+e.h+"px;"),"number"==typeof e.e[1]&&0<e.e[1]&&e.e[1]<e.p?n.push("width:"+(e.p-e.e[1])+"px; padding-left:"+e.e[1]+"px;"):n.push("width:"+e.p+"px; text-align:center;")):n.push("height:"+e.h+"px; line-height:"+e.h+"px; width:"+e.p+"px; text-align:center;"),n.push("cursor:pointer; top:"+t.y+"px; left:"+t.x+"px; color:"+(e.N?e.N:"black")+"; position:absolute; font-size:"+(e.O?e.O:11)+"px; font-family:Arial,sans-serif; font-weight:bold"),n.join("")}define("plugins/async",[],function(){function n(e){var t,n;t=document.createElement("script"),t.type="text/javascript",t.async=!0,t.src=e,n=document.getElementsByTagName("script")[0],n.parentNode.insertBefore(t,n)}function r(t,n){var r=/!(.+)/,i=t.replace(r,""),s=r.test(t)?t.replace(/.+!/,""):e;return i+=i.indexOf("?")<0?"?":"&",i+s+"="+n}function i(){return t+=1,"__async_req_"+t+"__"}var e="callback",t=0;return{load:function(e,t,s,o){if(o.isBuild)s(null);else{var u=i();window[u]=s,n(r(e,u))}}}}),define("modules/adapters/google-maps",["plugins/async!http://maps.googleapis.com/maps/api/js?key=AIzaSyAfvKdYJEDOZaDFxxDhFgEGU46tSnQbFDQ&sensor=false"],function(){return window.google});var k;k=l.prototype,k.R="http://google-maps-utility-library-v3.googlecode.com/svn/trunk/markerclusterer/images/m",k.Q="png",k.extend=function(e,t){return function(e){for(var t in e.prototype)this.prototype[t]=e.prototype[t];return this}.apply(e,[t])},k.onAdd=function(){this.A||(this.A=!0,p(this))},k.draw=function(){},k.T=function(){for(var e=this.o(),t=new google.maps.LatLngBounds,n=0,r;r=e[n];n++)t.extend(r.getPosition());this.b.fitBounds(t)},k.w=f("j"),k.o=f("a"),k.W=function(){return this.a.length},k.ca=d("K"),k.J=f("K"),k.G=function(e,t){for(var n=0,r=e.length,i=r;0!==i;)i=parseInt(i/10,10),n++;return n=Math.min(n,t),{text:r,index:n}},k.aa=d("G"),k.H=f("G"),k.C=function(e,t){if(e.length)for(var n=0,r;r=e[n];n++)s(this,r);else if(Object.keys(e).length)for(r in e)s(this,e[r]);t||this.i()},k.q=function(e,t){s(this,e),t||this.i()},k.Z=function(e,n){var r=t(this,e);return!n&&r?(this.m(),this.i(),!0):!1},k.$=function(e,n){for(var r=!1,i=0,s;s=e[i];i++)s=t(this,s),r=r||s;if(!n&&r)return this.m(),this.i(),!0},k.V=function(){return this.f.length},k.getMap=f("b"),k.setMap=d("b"),k.I=f("g"),k.ba=d("g"),k.v=function(e){var t=this.getProjection(),n=new google.maps.LatLng(e.getNorthEast().lat(),e.getNorthEast().lng()),r=new google.maps.LatLng(e.getSouthWest().lat(),e.getSouthWest().lng()),n=t.fromLatLngToDivPixel(n);return n.x+=this.g,n.y-=this.g,r=t.fromLatLngToDivPixel(r),r.x-=this.g,r.y+=this.g,n=t.fromDivPixelToLatLng(n),t=t.fromDivPixelToLatLng(r),e.extend(n),e.extend(t),e},k.S=function(){this.m(!0),this.a=[]},k.m=function(e){for(var t=0,n;n=this.f[t];t++)n.remove();for(t=0;n=this.a[t];t++)n.s=!1,e&&n.setMap(null);this.f=[]},k.M=function(){var e=this.f.slice();this.f.length=0,this.m(),this.i(),window.setTimeout(function(){for(var t=0,n;n=e[t];t++)n.remove()},0)},k.i=function(){p(this)},k=v.prototype,k.q=function(e){var t;e:if(this.a.indexOf)t=-1!=this.a.indexOf(e);else{t=0;for(var n;n=this.a[t];t++)if(n==e){t=!0;break e}t=!1}if(t)return!1;this.d?this.r&&(n=this.a.length+1,t=(this.d.lat()*(n-1)+e.getPosition().lat())/n,n=(this.d.lng()*(n-1)+e.getPosition().lng())/n,this.d=new google.maps.LatLng(t,n),A(this)):(this.d=e.getPosition(),A(this)),e.s=!0,this.a.push(e),t=this.a.length,t<this.l&&e.getMap()!=this.b&&e.setMap(this.b);if(t==this.l)for(n=0;n<t;n++)this.a[n].setMap(null);t>=this.l&&e.setMap(null),e=this.b.getZoom();if((t=this.k.J())&&e>t)for(e=0;t=this.a[e];e++)t.setMap(this.b);else this.a.length<this.l?B(this.n):(t=this.k.H()(this.a,this.k.w().length),this.n.setCenter(this.d),e=this.n,e.B=t,e.c&&(e.c.innerHTML=t.text),t=Math.max(0,e.B.index-1),t=Math.min(e.j.length-1,t),t=e.j[t],e.ea=t.url,e.h=t.height,e.p=t.width,e.N=t.textColor,e.e=t.anchor,e.O=t.textSize,e.D=t.backgroundPosition,this.n.show());return!0},k.getBounds=function(){for(var e=new google.maps.LatLngBounds(this.d,this.d),t=this.o(),n=0,r;r=t[n];n++)e.extend(r.getPosition());return e},k.remove=function(){this.n.remove(),this.a.length=0,delete this.a},k.U=function(){return this.a.length},k.o=f("a"),k.getCenter=f("d"),k.getMap=f("b"),k=w.prototype,k.onAdd=function(){this.c=document.createElement("DIV");if(this.t){var e=C(this,this.d);this.c.style.cssText=D(this,e),this.c.innerHTML=this.B.text}this.getPanes().overlayMouseTarget.appendChild(this.c);var t=this;google.maps.event.addDomListener(this.c,"click",function(){var e=t.u.k;google.maps.event.trigger(e,"clusterclick",t.u),e.P&&t.b.fitBounds(t.u.getBounds())})},k.draw=function(){if(this.t){var e=C(this,this.d);this.c.style.top=e.y+"px",this.c.style.left=e.x+"px"}},k.show=function(){if(this.c){var e=C(this,this.d);this.c.style.cssText=D(this,e),this.c.style.display=""}this.t=!0},k.remove=function(){this.setMap(null)},k.onRemove=function(){this.c&&this.c.parentNode&&(B(this),this.c.parentNode.removeChild(this.c),this.c=null)},k.setCenter=d("d"),window.MarkerClusterer=l,l.prototype.addMarker=l.prototype.q,l.prototype.addMarkers=l.prototype.C,l.prototype.clearMarkers=l.prototype.S,l.prototype.fitMapToMarkers=l.prototype.T,l.prototype.getCalculator=l.prototype.H,l.prototype.getGridSize=l.prototype.I,l.prototype.getExtendedBounds=l.prototype.v,l.prototype.getMap=l.prototype.getMap,l.prototype.getMarkers=l.prototype.o,l.prototype.getMaxZoom=l.prototype.J,l.prototype.getStyles=l.prototype.w,l.prototype.getTotalClusters=l.prototype.V,l.prototype.getTotalMarkers=l.prototype.W,l.prototype.redraw=l.prototype.i,l.prototype.removeMarker=l.prototype.Z,l.prototype.removeMarkers=l.prototype.$,l.prototype.resetViewport=l.prototype.m,l.prototype.repaint=l.prototype.M,l.prototype.setCalculator=l.prototype.aa,l.prototype.setGridSize=l.prototype.ba,l.prototype.setMaxZoom=l.prototype.ca,l.prototype.onAdd=l.prototype.onAdd,l.prototype.draw=l.prototype.draw,v.prototype.getCenter=v.prototype.getCenter,v.prototype.getSize=v.prototype.U,v.prototype.getMarkers=v.prototype.o,w.prototype.onAdd=w.prototype.onAdd,w.prototype.draw=w.prototype.draw,w.prototype.onRemove=w.prototype.onRemove,Object.keys=Object.keys||function(e){var t=[],n;for(n in e)e.hasOwnProperty(n)&&t.push(n);return t},define("marker-clusterer",["google/maps"],function(e){return function(){var t,n;return t||e.MarkerClusterer}}(this)),function(){var e;e=function(e){var t,n;return t=!1,e(function(){var r;return r=(document.body||document.documentElement).style,t=r.animation!==void 0||r.WebkitAnimation!==void 0||r.MozAnimation!==void 0||r.MsAnimation!==void 0||r.OAnimation!==void 0,e(window).bind("keyup.vex",function(e){if(e.keyCode===27)return n.closeByEscape()})}),n={globalID:1,animationEndEvent:"animationend webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend",baseClassNames:{vex:"vex",content:"vex-content",overlay:"vex-overlay",close:"vex-close",closing:"vex-closing",open:"vex-open"},defaultOptions:{content:"",showCloseButton:!0,escapeButtonCloses:!0,overlayClosesOnClick:!0,appendLocation:"body",className:"",css:{},overlayClassName:"",overlayCSS:{},contentClassName:"",contentCSS:{},closeClassName:"",closeCSS:{}},open:function(t){return t=e.extend({},n.defaultOptions,t),t.id=n.globalID,n.globalID+=1,t.$vex=e("<div>").addClass(n.baseClassNames.vex).addClass(t.className).css(t.css).data({vex:t}),t.$vexOverlay=e("<div>").addClass(n.baseClassNames.overlay).addClass(t.overlayClassName).css(t.overlayCSS).data({vex:t}),t.overlayClosesOnClick&&t.$vexOverlay.bind("click.vex",function(t){if(t.target!==this)return;return n.close(e(this).data().vex.id)}),t.$vex.append(t.$vexOverlay),t.$vexContent=e("<div>").addClass(n.baseClassNames.content).addClass(t.contentClassName).css(t.contentCSS).append(t.content).data({vex:t}),t.$vex.append(t.$vexContent),t.showCloseButton&&(t.$closeButton=e("<div>").addClass(n.baseClassNames.close).addClass(t.closeClassName).css(t.closeCSS).data({vex:t}).bind("click.vex",function(){return n.close(e(this).data().vex.id)}),t.$vexContent.append(t.$closeButton)),e(t.appendLocation).append(t.$vex),n.setupBodyClassName(t.$vex),t.afterOpen&&t.afterOpen(t.$vexContent,t),setTimeout(function(){return t.$vexContent.trigger("vexOpen",t)},0),t.$vexContent},getAllVexes:function(){return e("."+n.baseClassNames.vex+':not(".'+n.baseClassNames.closing+'") .'+n.baseClassNames.content)},getVexByID:function(t){return n.getAllVexes().filter(function(){return e(this).data().vex.id===t})},close:function(e){var t;if(!e){t=n.getAllVexes().last();if(!t.length)return!1;e=t.data().vex.id}return n.closeByID(e)},closeAll:function(){var t;return t=n.getAllVexes().map(function(){return e(this).data().vex.id}).toArray(),(t!=null?!t.length:!void 0)?!1:(e.each(t.reverse(),function(e,t){return n.closeByID(t)}),!0)},closeByID:function(r){var i,s,o,u,a;s=n.getVexByID(r);if(!s.length)return;return i=s.data().vex.$vex,a=e.extend({},s.data().vex),o=function(){if(a.beforeClose)return a.beforeClose(s,a)},u=function(){s.trigger("vexClose",a),i.remove();if(a.afterClose)return a.afterClose(s,a)},t?(o(),i.unbind(n.animationEndEvent).bind(n.animationEndEvent,function(){return u()}).addClass(n.baseClassNames.closing)):(o(),u()),!0},closeByEscape:function(){var t,r,i;return i=n.getAllVexes().map(function(){return e(this).data().vex.id}).toArray(),(i!=null?!i.length:!void 0)?!1:(r=Math.max.apply(Math,i),t=n.getVexByID(r),t.data().vex.escapeButtonCloses!==!0?!1:n.closeByID(r))},setupBodyClassName:function(t){return t.bind("vexOpen.vex",function(){return e("body").addClass(n.baseClassNames.open)}).bind("vexClose.vex",function(){if(!n.getAllVexes().length)return e("body").removeClass(n.baseClassNames.open)})},hideLoading:function(){return e(".vex-loading-spinner").remove()},showLoading:function(){return n.hideLoading(),e("body").append('<div class="vex-loading-spinner '+n.defaultOptions.className+'"></div>')}}},typeof define=="function"&&define.amd?define("vex",["jquery"],e):typeof exports=="object"?module.exports=e(require("jquery")):window.vex=e(jQuery)}.call(this),function(){var e;e=function(e,t){var n,r;return t==null?e.error("Vex is required to use vex.dialog"):(n=function(t){var n;return n={},e.each(t.serializeArray(),function(){return n[this.name]?(n[this.name].push||(n[this.name]=[n[this.name]]),n[this.name].push(this.value||"")):n[this.name]=this.value||""}),n},r={},r.buttons={YES:{text:"OK",type:"submit",className:"vex-dialog-button-primary"},NO:{text:"Cancel",type:"button",className:"vex-dialog-button-secondary",click:function(e,n){return e.data().vex.value=!1,t.close(e.data().vex.id)}}},r.defaultOptions={callback:function(e){if(console&&console.log)return console.log("Vex dialog callback:",e)},afterOpen:function(){},message:"Message",input:'<input name="vex" type="hidden" value="_vex-empty-value" />',value:!1,buttons:[r.buttons.YES,r.buttons.NO],showCloseButton:!1,onSubmit:function(i){var s,o;return s=e(this),o=s.parent(),i.preventDefault(),i.stopPropagation(),o.data().vex.value=r.getFormValueOnSubmit(n(s)),t.close(o.data().vex.id)},focusFirstInput:!0},r.defaultAlertOptions={message:"Alert",buttons:[r.buttons.YES]},r.defaultConfirmOptions={message:"Confirm"},r.open=function(n){var i;return n=e.extend({},t.defaultOptions,r.defaultOptions,n),n.content=r.buildDialogForm(n),n.beforeClose=function(e){return n.callback(e.data().vex.value)},i=t.open(n),n.focusFirstInput&&i.find('input[type="text"], input[type="submit"]').first().focus(),i},r.alert=function(t){return typeof t=="string"&&(t={message:t}),t=e.extend({},r.defaultAlertOptions,t),r.open(t)},r.confirm=function(t){return typeof t=="string"?e.error("dialog.confirm(options) requires options.callback."):(t=e.extend({},r.defaultConfirmOptions,t),r.open(t))},r.prompt=function(t){var n;return typeof t=="string"?e.error("dialog.prompt(options) requires options.callback."):(n={message:'<label for="vex">'+(t.label||"Prompt:")+"</label>",input:'<input name="vex" type="text" class="vex-dialog-prompt-input" placeholder="'+(t.placeholder||"")+'" />'},t=e.extend({},n,t),r.open(t))},r.buildDialogForm=function(t){var n,i,s;return n=e('<form class="vex-dialog-form" />'),s=e('<div class="vex-dialog-message" />'),i=e('<div class="vex-dialog-input" />'),n.append(s.append(t.message)).append(i.append(t.input)).append(r.buttonsToDOM(t.buttons)).bind("submit.vex",t.onSubmit),n},r.getFormValueOnSubmit=function(e){return e.vex?e.vex==="_vex-empty-value"?!0:e.vex:e},r.buttonsToDOM=function(n){var r;return r=e('<div class="vex-dialog-buttons" />'),e.each(n,function(i,s){return r.append(e('<input type="'+s.type+'" />').val(s.text).addClass(s.className+" vex-dialog-button "+(i===0?"vex-first ":"")+(i===n.length-1?"vex-last ":"")).bind("click.vex",function(n){if(s.click)return s.click(e(this).parents("."+t.baseClassNames.content),n)}))}),r},r)},typeof define=="function"&&define.amd?define("vex.dialog",["jquery","vex"],e):typeof exports=="object"?module.exports=e(require("jquery"),require("vex")):window.vex.dialog=e(window.jQuery,window.vex)}.call(this),define("text",["module"],function(e){var t,n,r,i,s,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],u=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,a=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,f=typeof location!="undefined"&&location.href,l=f&&location.protocol&&location.protocol.replace(/\:/,""),c=f&&location.hostname,h=f&&(location.port||undefined),p={},d=e.config&&e.config()||{};t={version:"2.0.10",strip:function(e){if(e){e=e.replace(u,"");var t=e.match(a);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:d.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=o[t];try{e=new ActiveXObject(n)}catch(r){}if(e){o=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,s=e.indexOf("."),o=e.indexOf("./")===0||e.indexOf("../")===0;return s!==-1&&(!o||s>1)?(t=e.substring(0,s),n=e.substring(s+1,e.length)):t=e,r=n||t,s=r.indexOf("!"),s!==-1&&(i=r.substring(s+1)==="strip",r=r.substring(0,s),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,d.isBuild&&(p[e]=r),i(r)},load:function(e,n,r,i){if(i.isBuild&&!i.inlineText){r();return}d.isBuild=i.isBuild;var s=t.parseName(e),o=s.moduleName+(s.ext?"."+s.ext:""),u=n.toUrl(o),a=d.useXhr||t.useXhr;if(u.indexOf("empty:")===0){r();return}!f||a(u,l,c,h)?t.get(u,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([o],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(p.hasOwnProperty(n)){var s=t.jsEscape(p[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.ext?"."+o.ext:"",a=o.moduleName+u,f=r.toUrl(o.moduleName+u)+".js";t.load(a,r,function(n){var r=function(e){return i(f,e)};r.asModule=function(e,t){return i.asModule(e,f,t)},t.write(e,a,r,s)},s)}};if(d.env==="node"||!d.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node&&!process.versions["node-webkit"])n=require.nodeRequire("fs"),t.get=function(e,t,r){try{var i=n.readFileSync(e,"utf8");i.indexOf("﻿")===0&&(i=i.substring(1)),t(i)}catch(s){r(s)}};else if(d.env==="xhr"||!d.env&&t.createXhr())t.get=function(e,n,r,i){var s=t.createXhr(),o;s.open("GET",e,!0);if(i)for(o in i)i.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),i[o]);d.onXhr&&d.onXhr(s,e),s.onreadystatechange=function(t){var i,o;s.readyState===4&&(i=s.status,i>399&&i<600?(o=new Error(e+" HTTP status: "+i),o.xhr=s,r(o)):n(s.responseText),d.onXhrComplete&&d.onXhrComplete(s,e))},s.send(null)};else if(d.env==="rhino"||!d.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),r!==null&&n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};else if(d.env==="xpconnect"||!d.env&&typeof Components!="undefined"&&Components.classes&&Components.interfaces)r=Components.classes,i=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),s="@mozilla.org/windows-registry-key;1"in r,t.get=function(e,t){var n,o,u,a={};s&&(e=e.replace(/\//g,"\\")),u=new FileUtils.File(e);try{n=r["@mozilla.org/network/file-input-stream;1"].createInstance(i.nsIFileInputStream),n.init(u,1,0,!1),o=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(i.nsIConverterInputStream),o.init(n,"utf-8",n.available(),i.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),o.readString(n.available(),a),o.close(),n.close(),t(a.value)}catch(f){throw new Error((u&&u.path||"")+": "+f)}};return t}),function(){function encodeHTMLSource(){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},t=/&(?!#?\w+;)|<|>|"|'|\//g;return function(){return this?this.replace(t,function(t){return e[t]||t}):this}}function resolveDefs(e,t,n){return(typeof t=="string"?t:t.toString()).replace(e.define||skip,function(t,r,i,s){return r.indexOf("def.")===0&&(r=r.substring(4)),r in n||(i===":"?(e.defineParams&&s.replace(e.defineParams,function(e,t,i){n[r]={arg:t,text:i}}),r in n||(n[r]=s)):(new Function("def","def['"+r+"']="+s))(n)),""}).replace(e.use||skip,function(t,r){e.useParams&&(r=r.replace(e.useParams,function(e,t,r,i){if(n[r]&&n[r].arg&&i){var s=(r+":"+i).replace(/'|\\/g,"_");return n.__exp=n.__exp||{},n.__exp[s]=n[r].text.replace(new RegExp("(^|[^\\w$])"+n[r].arg+"([^\\w$])","g"),"$1"+i+"$2"),t+"def.__exp['"+s+"']"}}));var i=(new Function("def","return "+r))(n);return i?resolveDefs(e,i,n):i})}function unescape(e){return e.replace(/\\('|\\)/g,"$1").replace(/[\r\t\n]/g," ")}var doT={version:"1.0.1",templateSettings:{evaluate:/\{\{([\s\S]+?(\}?)+)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,encode:/\{\{!([\s\S]+?)\}\}/g,use:/\{\{#([\s\S]+?)\}\}/g,useParams:/(^|[^\w$])def(?:\.|\[[\'\"])([\w$\.]+)(?:[\'\"]\])?\s*\:\s*([\w$\.]+|\"[^\"]+\"|\'[^\']+\'|\{[^\}]+\})/g,define:/\{\{##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)#\}\}/g,defineParams:/^\s*([\w$]+):([\s\S]+)/,conditional:/\{\{\?(\?)?\s*([\s\S]*?)\s*\}\}/g,iterate:/\{\{~\s*(?:\}\}|([\s\S]+?)\s*\:\s*([\w$]+)\s*(?:\:\s*([\w$]+))?\s*\}\})/g,varname:"it",strip:!0,append:!0,selfcontained:!1},template:undefined,compile:undefined},global;typeof module!="undefined"&&module.exports?module.exports=doT:typeof define=="function"&&define.amd?define("dot",[],function(){return doT}):(global=function(){return this||(0,eval)("this")}(),global.doT=doT),String.prototype.encodeHTML=encodeHTMLSource();var startend={append:{start:"'+(",end:")+'",endencode:"||'').toString().encodeHTML()+'"},split:{start:"';out+=(",end:");out+='",endencode:"||'').toString().encodeHTML();out+='"}},skip=/$^/;doT.template=function(e,t,n){t=t||doT.templateSettings;var r=t.append?startend.append:startend.split,i,s=0,o,u=t.use||t.define?resolveDefs(t,e,n||{}):e;u=("var out='"+(t.strip?u.replace(/(^|\r|\n)\t* +| +\t*(\r|\n|$)/g," ").replace(/\r|\n|\t|\/\*[\s\S]*?\*\//g,""):u).replace(/'|\\/g,"\\$&").replace(t.interpolate||skip,function(e,t){return r.start+unescape(t)+r.end}).replace(t.encode||skip,function(e,t){return i=!0,r.start+unescape(t)+r.endencode}).replace(t.conditional||skip,function(e,t,n){return t?n?"';}else if("+unescape(n)+"){out+='":"';}else{out+='":n?"';if("+unescape(n)+"){out+='":"';}out+='"}).replace(t.iterate||skip,function(e,t,n,r){return t?(s+=1,o=r||"i"+s,t=unescape(t),"';var arr"+s+"="+t+";if(arr"+s+"){var "+n+","+o+"=-1,l"+s+"=arr"+s+".length-1;while("+o+"<l"+s+"){"+n+"=arr"+s+"["+o+"+=1];out+='"):"';} } out+='"}).replace(t.evaluate||skip,function(e,t){return"';"+unescape(t)+"out+='"})+"';return out;").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/(\s|;|\}|^|\{)out\+='';/g,"$1").replace(/\+''/g,"").replace(/(\s|;|\}|^|\{)out\+=''\+/g,"$1out+="),i&&t.selfcontained&&(u="String.prototype.encodeHTML=("+encodeHTMLSource.toString()+"());"+u);try{return new Function(t.varname,u)}catch(a){throw typeof console!="undefined"&&console.log("Could not create a template function: "+u),a}},doT.compile=function(e,t){return doT.template(e,null,t)}}(),define("tpl",["text","dot"],function(e,t){function u(e,t,r,i){n[e]=t,r(t)}function a(r,s,o,a){r in n?o(n[r]):e.get(s.toUrl(r),function(e){var n={render:t.template(e,i)};u(r,n,o,a)})}function f(e,t,r,i){if(t in n){var s=n[t].render.toString();r.asModule(e+"!"+t,"define({ render: "+s+" });\n")}}var n={},r="it",i={},s={varname:r};for(var o in t.templateSettings)i[o]=s[o]||t.templateSettings[o];return{load:a}}),define("json",["text"],function(text){function cacheBust(e){return e=e.replace(CACHE_BUST_FLAG,""),e+=e.indexOf("?")<0?"?":"&",e+CACHE_BUST_QUERY_PARAM+"="+Math.round(2147483647*Math.random())}var CACHE_BUST_QUERY_PARAM="bust",CACHE_BUST_FLAG="!bust",jsonParse=typeof JSON!="undefined"&&typeof JSON.parse=="function"?JSON.parse:function(val){return eval("("+val+")")},buildMap={};return{load:function(e,t,n,r){!r.isBuild||r.inlineJSON!==!1&&e.indexOf(CACHE_BUST_QUERY_PARAM+"=")===-1?text.get(t.toUrl(e),function(t){r.isBuild?(buildMap[e]=t,n(t)):n(jsonParse(t))},n.error,{accept:"application/json"}):n(null)},normalize:function(e,t){return e.indexOf(CACHE_BUST_FLAG)!==-1&&(e=cacheBust(e)),t(e)},write:function(e,t,n){if(t in buildMap){var r=buildMap[t];n('define("'+e+"!"+t+'", function(){ return '+r+";});\n")}}}}),define("json!data/postcards.json",function(){return[{title:"Some City",img:"test.jpg",lat:43.0936,lng:-79.0593}]}),define("mediators/main",["jquery","stapes","google/maps","marker-clusterer","vex","vex.dialog","tpl!templates/postcard-info-window.tpl","json!data/postcards.json"],function(e,t,n,r,i,s,o,u){i.defaultOptions.className="vex-theme-default",s.defaultOptions.showCloseButton=!0;var a=t.subclass({constructor:function(){var t=this;t.initEvents(),e(function(){t.emit("domready")})},initEvents:function(){var e=this;e.on("domready",e.onDomReady)},onDomReady:function(){var t=this;t.el=e("#wrap-map");var i={center:new n.maps.LatLng(30,0),zoom:2,minZoom:2,mapTypeId:n.maps.MapTypeId.ROADMAP},a=t.map=new n.maps.Map(t.el[0],i),f=[];e.each(u,function(t,r){var i,u=o.render(r),l=new n.maps.Marker({position:new n.maps.LatLng(r.lat,r.lng),map:a});f.push(l),n.maps.event.addListener(l,"click",function(){s.open({message:!1,input:u,buttons:[e.extend({},s.buttons.YES,{text:"Close"})],callback:e.noop})})});var l=new r(a,f,{zoomOnClick:!0,gridSize:20})}});return new a}),require(["config/require-config"],function(){require(["mediators/main"])}),define("page-main",function(){}),define("page-main",function(){});